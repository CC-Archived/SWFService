/*!
 * [SWFService](http://github.com/CodeCatalyst/SWFService) v2.0.0
 * Copyright (c) 2008-2013 [CodeCatalyst, LLC](http://codecatalyst.com)
 * Open source under the [MIT License](http://en.wikipedia.org/wiki/MIT_License).
 */
/*!
 * [promise.coffee](http://github.com/CodeCatalyst/promise.coffee) v1.0
 * Copyright (c) 2012-2013 [CodeCatalyst, LLC](http://www.codecatalyst.com/).
 * Open source under the [MIT License](http://en.wikipedia.org/wiki/MIT_License).
 */
(function(){var a,b,f,e,d,c;d=(typeof process!=="undefined"&&process!==null?process.nextTick:void 0)||(typeof setImmediate!=="undefined"&&setImmediate!==null)||function(g){return setTimeout(g,0)};e=function(g){return typeof g==="function"};f=(function(){function g(t,h){var j,q,p,l,s,r,o,i,k,n,m;this.promise=new b(this);o=[];k=false;l=false;r=null;s=null;if(!e(h)){h=function(u){throw u}}n=function(){var v,w,u;for(w=0,u=o.length;w<u;w++){v=o[w];v[s](r)}o=[]};m=function(u){o.push(u);if(l){n()}};j=function(v,u){t=h=null;s=v;r=u;l=true;n()};p=function(u){j("resolve",u)};q=function(u){j("reject",u)};i=function(w,v){k=true;try{if(e(w)){v=w(v)}if(v&&e(v.then)){v.then(p,q)}else{p(v)}}catch(u){q(u)}};this.resolve=function(u){if(!k){i(t,u)}};this.reject=function(u){if(!k){i(h,u)}};this.then=function(w,u){var v;if(e(w)||e(u)){v=new g(w,u);d(function(){return m(v)});return v.promise}return this.promise}}return g})();b=(function(){function g(h){this.then=function(j,i){return h.then(j,i)}}return g})();a=(function(){function g(){var h;h=new f();this.promise=h.promise;this.resolve=function(i){return h.resolve(i)};this.reject=function(i){return h.reject(i)}}return g})();c=typeof exports!=="undefined"&&exports!==null?exports:window;c.Deferred=a;c.defer=function(){return new a()}}).call(this);(function(){var d,c,b,f,a,e,g;d=(function(){function h(i,j){this.entityClass=i;this.entityKeyProperty=j!=null?j:"id";this.entitiesByKey={}}h.prototype.add=function(i){var j;if(!(i instanceof this.entityClass)){throw new Error("Entity must be of type: "+this.entityClass.name+" to be added to this EntitySet.")}j=i[this.entityKeyProperty];if(this.exists(j)){throw new Error("An Entity with key: "+j+" already exists in this EntitySet.")}this.entitiesByKey[j]=i;return i};h.prototype.remove=function(i){if(this.contains(i)){delete this.entitiesByKey[i[this.entityKeyProperty]];return i}return null};h.prototype.removeAll=function(){this.entitiesByKey={}};h.prototype.get=function(i){return this.entitiesByKey[i]};h.prototype.find=function(i){var j;j=function(k){var m,l;for(m in i){l=i[m];if(k[m]!==l){return false}}return true};return this.match(j)};h.prototype.match=function(k){var i,j,m,l;m=[];l=this.entitiesByKey;for(j in l){i=l[j];if(k(i)){m.push(i)}}return m};h.prototype.contains=function(i){var j;j=i[this.entityKeyProperty];return this.exists(j)&&i===this.get(j)};h.prototype.exists=function(i){return this.entitiesByKey[i]!=null};h.prototype.toArray=function(){var l,i,j,k;l=[];k=this.entitiesByKey;for(j in k){i=k[j];l.push(i)}return l};return h})();e=(function(){function h(x,t){var j,i,v,s,p,q,u,m,l,k,w,z,y,r,o,n;this.id=t;i=function(A){return function(){return x.getServiceProperty(t,A)}};s=function(A){return function(B){x.setServiceProperty(t,A,B)}};v=function(A){return function(){var B;B=Array.prototype.slice.call(arguments);return x.executeServiceMethod(t,A,B)}};q=x.getServiceDescriptor(t);r=q.accessors;for(m=0,w=r.length;m<w;m++){j=r[m];Object.defineProperty(this,j.name,{writeable:j.access!=="readonly",get:i(j.name),set:s(j.name)})}o=q.variables;for(l=0,z=o.length;l<z;l++){u=o[l];Object.defineProperty(this,u.name,{get:i(u.name),set:s(u.name)})}n=q.methods;for(k=0,y=n.length;k<y;k++){p=n[k];this[p.name]=v(p.name)}if(q.isEventDispatcher){this.addEventListener=function(C,D,A,B,E){if(A==null){A=false}if(B==null){B=0}if(E==null){E=false}x.addServiceEventListener(t,C,D,A,B,E)};this.removeEventListener=function(B,C,A){if(A==null){A=false}x.removeServiceEventListener(t,B,C,A)}}}return h})();a=(function(){function h(m,l,j,k){var i;this.id=m;this.serviceId=l;this.methodName=j;this.args=k;i=new Deferred();this.promise=i.promise,this.resolve=i.resolve,this.reject=i.reject}return h})();f=(function(){function h(o,m,k,n,i,j,l){this.id=o;this.serviceId=m;this.eventType=k;this.listenerFunction=n;this.useCapture=i!=null?i:false;this.priority=j!=null?j:0;this.useWeakReference=l!=null?l:false}h.prototype.matches=function(k,j,l,i){return this.serviceId===k&&this.eventType===j&&this.listenerFunction===l&&this.useCapture===i};h.prototype.redispatch=function(i){return this.listenerFunction(i)};return h})();b=(function(){function h(i){this.swf=i;this.id=this.swf.SWFServiceContext_getId();this.serviceProxies=new d(e);this.serviceOperationProxies=new d(a);this.serviceEventListenerProxies=new d(f);return}h.prototype.get=function(i){return this.serviceProxies.get(i)||this.serviceProxies.add(new e(this,i))};h.prototype.getServiceDescriptor=function(i){return this.swf.SWFServiceContext_getServiceDescriptor(i)};h.prototype.getServiceProperty=function(j,i){return this.swf.SWFServiceContext_getServiceProperty(j,i)};h.prototype.setServiceProperty=function(k,i,j){this.swf.SWFServiceContext_setServiceProperty(k,i,j)};h.prototype.executeServiceMethod=function(m,j,k){var l,i;l=this.swf.SWFServiceContext_executeServiceMethod(m,j,k);if(l.pending){i=new a(l.operationId,m,j,k);this.serviceOperationProxies.add(i);return i.promise}return l.value};h.prototype.addServiceEventListener=function(m,l,n,i,k,o){var j;j=this.swf.SWFServiceContext_addServiceEventListener(m,l,i,k,o);this.serviceEventListenerProxies.add(new f(j,m,l,n,i,k,o))};h.prototype.removeServiceEventListener=function(l,j,m,i){var k;k=this.serviceEventListenerProxies.find({serviceId:l,eventType:j,listenerFunction:m,useCapture:i})[0];if(k!=null){this.swf.SWFServiceContext_removeServiceEventListener(l,k.id);this.serviceEventListenerProxies.remove(k)}};h.prototype.onServiceExecuteComplete=function(m,j,l,k){var i;i=this.serviceOperationProxies.get(j);if(i!=null){i[l](k);this.serviceOperationProxies.remove(i)}};h.prototype.onServiceEvent=function(k,i,j){return this.serviceEventListenerProxies.get(i).redispatch(j)};return h})();c=(function(){function h(){this.serviceContexts=new d(b)}h.prototype.get=function(i,k){var j;j=this.serviceContexts.find({swf:i})[0]||this.serviceContexts.add(new b(i));return j.get(k)};h.prototype.onServiceExecuteComplete=function(m,l,i,k,j){return this.serviceContexts.get(m).onServiceExecuteComplete(l,i,k,j)};h.prototype.onServiceEvent=function(l,k,i,j){return this.serviceContexts.get(l).onServiceEvent(k,i,j)};return h})();g=typeof exports!=="undefined"&&exports!==null?exports:window;g.SWFService=new c()}).call(this);
